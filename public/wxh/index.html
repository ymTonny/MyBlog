<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>微信视频号地址解析工具</title>
</head>
<body>
  <div>
    <h2>微信视频号地址解析工具</h2>
  </div>
  <div>
    <textarea id="txt" rows="20" cols="90"></textarea>
    <br>
    <!-- 链接：<a id="result" href="#" target="_blank">未解析</a> -->
    <br>
    <button onclick="prase()">解析下载</button>
  </div>
</body>

<script type="text/javascript">
function prase() {
  const regex = /<video.*?src="([^"]*)"[^>]*>(?:<\/video>)?/gm;
  const str = document.getElementById('txt').value;
  let url;
  let m;

  while ((m = regex.exec(str)) !== null) {
    if (m.index === regex.lastIndex) {
        regex.lastIndex++;
    }
    m.forEach((match, groupIndex) => {
        url = match;
    });
  }
  url = url.replace(/&amp;/g, '&');
  const a = document.createElement('a');
  // const href = ;
  a.style.display = 'none';
  a.href = url;
  a.target = "_blank";
  a.setAttribute("download", "wxh")
  a.click();
  // document.getElementById('result').innerText = url;
  // document.getElementById('result').setAttribute('href', url);
}
</script>
</html>
